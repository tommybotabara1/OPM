{% extends "home/patientHeaderFooter.html" %}
{% load staticfiles%}

{% block content %}
    <title> OPHM - Restrict User Access </title>
        <!------------------------------------------------------- BODY STARTS HERE ------------------------------------------------------------->
    <div class="col s12 m12 l12  white">
            <div class="row center">
                <div class="col s3"></div>
                <div class="col s6">
                    <h3 id="greeting"><i class="material-icons" style="font-size: 40px;">highlight_off</i>&nbsp;&nbsp; Restrict Data Access</h3>
                    <small>The latest medical information and today's current vitals (if any) will not be restricted</small>
                </div>
                <div class="col s3"></div>
            </div>
            <div class="divider"></div>
            <div class="section"></div>



            <div class = "row">
                <div class="col s3 white"></div>
                <div class="col s6 white left">
                        <h5><B>Doctor</B> can:</h5>
                        {% if patient.restrictmedicalinformationaccess == 0 %}
                            <p><label><input id="medicalInformation" type="checkbox" class="filled-in" checked="checked" /><span>View Past Medical Information</span></label></p>
                        {% else %}
                            <p><label><input id="medicalInformation" type="checkbox" class="filled-in" /><span>View Past Medical Information</span></label></p>
                        {% endif %}

                        {% if patient.restrictvitalsinformationaccess == 0 %}
                            <p><label><input id="vitalRecords" type="checkbox" class="filled-in" checked="checked" /><span>View Past Historical Vital Records</span></label></p>
                        {% else %}
                            <p><label><input id="vitalRecords" type="checkbox" class="filled-in" /><span>View Past Historical Vital Records</span></label></p>
                        {% endif %}

                </div>
                <div class="col s3 white"></div>
                <div class="col s12 white">
                    <div class="row center">
                        <button id="saveButton" class="btn btn-large waves-effect red lighten-2 center" type="submit">Save</button>
                    </div>
                </div>
            </div>
    </div>

<script>
    $("#saveButton").click(function() {
        var medicalInformation = -1;
        var vitalRecords = -1;
        if($("#medicalInformation").is(':checked'))
            medicalInformation = 0;
        else
            medicalInformation = 1;

        if($("#vitalRecords").is(':checked'))
            vitalRecords = 0;
        else
            vitalRecords = 1;

        $.ajax({
        url: '{% url 'update_patient_restrictions' %}',
        data: {
          'patient_id': {{ patient.patientid }},
          'medicalInformation': medicalInformation,
          'vitalRecords': vitalRecords,
        },
        dataType: 'json',
        success: function (data) {
            alert(data[0].response);
            location.reload();

        }

        });

    });
</script>

{% endblock %}